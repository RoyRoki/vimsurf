(()=>{var e={130:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return r};const r={core:(0,o(n(270)).default)()}},184:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scrollActions=void 0,t.default=function(){return t.scrollActions};const o=n(866),r=new class{constructor(){this.panes=[],this.currentIndex=0,this.refreshPanes(),window.addEventListener("resize",()=>this.refreshPanes())}isScrollable(e){const t=getComputedStyle(e).overflowY;return("auto"===t||"scroll"===t)&&e.scrollHeight>e.clientHeight}refreshPanes(){this.panes=Array.from(document.querySelectorAll("*")).filter(e=>this.isScrollable(e)),this.currentIndex=0}focusNext(){0!==this.panes.length&&(this.currentIndex=(this.currentIndex+1)%this.panes.length,this.highlightCurrent())}focusPrev(){0!==this.panes.length&&(this.currentIndex=(this.currentIndex-1+this.panes.length)%this.panes.length,this.highlightCurrent())}focusByIndex(e){e<0||e>=this.panes.length||(this.currentIndex=e,this.highlightCurrent())}get currentPane(){return this.panes[this.currentIndex]||null}highlightCurrent(){this.panes.forEach((e,t)=>{e.style.outline=t===this.currentIndex?"2px solid #4FD1C5":""});const e=this.currentPane;e?e.scrollIntoView({behavior:"smooth",block:"center"}):window.scrollTo({top:window.scrollY,behavior:"smooth"})}};t.scrollActions={scrollLine:({amount:e})=>{if(!(0,o.validateScrollAmount)(e))return;const t=r.currentPane;t?t.scrollBy({top:e,behavior:"smooth"}):window.scrollBy({top:e,behavior:"smooth"})},scrollHalfPage:({direction:e})=>{const t=r.currentPane,n=(t?t.clientHeight:window.innerHeight)/2*e;t?t.scrollBy({top:n,behavior:"smooth"}):window.scrollBy({top:n,behavior:"smooth"})},scrollFullPage:({direction:e})=>{const t=r.currentPane,n=(t?t.clientHeight:window.innerHeight)*e;t?t.scrollBy({top:n,behavior:"smooth"}):window.scrollBy({top:n,behavior:"smooth"})},jumpTop:()=>{const e=r.currentPane;e?e.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},jumpBottom:()=>{const e=r.currentPane,t=e?e.scrollHeight:document.body.scrollHeight;e?e.scrollTo({top:t,behavior:"smooth"}):window.scrollTo({top:t,behavior:"smooth"})},focusNextPane:()=>r.focusNext(),focusPrevPane:()=>r.focusPrev(),focusPaneByNumber:({index:e})=>r.focusByIndex(e),moveChild:()=>{const e=r.currentPane;if(!e)return;const t=Array.from(e.children).find(e=>e instanceof HTMLElement&&r.isScrollable(e));if(t){const e=r.panes.indexOf(t);r.focusByIndex(e)}},moveParent:()=>{const e=r.currentPane;if(!e)return;const t=e.parentElement;if(t&&r.isScrollable(t)){const e=r.panes.indexOf(t);r.focusByIndex(e)}}}},199:(e,t)=>{"use strict";function n(e){const t=[];if("object"!=typeof e||null===e||Array.isArray(e))return t.push({path:"",message:"manifest must be an object"}),{valid:!1,errors:t};for(const n of["name","version","commands"])n in e||t.push({path:n,message:"is required"});"name"in e&&"string"!=typeof e.name&&t.push({path:"name",message:"must be a string"}),"version"in e&&("string"!=typeof e.version?t.push({path:"version",message:"must be a string"}):/^\d+\.\d+\.\d+$/.test(e.version)||t.push({path:"version",message:"must match semver (x.y.z)"})),"priority"in e&&(Number.isInteger(e.priority)?e.priority<0&&t.push({path:"priority",message:"must be ≥ 0"}):t.push({path:"priority",message:"must be an integer"}));const n=new Set(["normal","insert","visual","operator-pending"]);if("modes"in e&&(Array.isArray(e.modes)?e.modes.forEach((e,o)=>{"string"!=typeof e?t.push({path:`modes[${o}]`,message:"must be a string"}):n.has(e)||t.push({path:`modes[${o}]`,message:`must be one of ${[...n].join(", ")}`})}):t.push({path:"modes",message:"must be an array"})),"commands"in e&&(Array.isArray(e.commands)?0===e.commands.length?t.push({path:"commands",message:"must have at least one entry"}):e.commands.forEach((e,n)=>{const o=`commands[${n}]`;if("object"!=typeof e||null===e||Array.isArray(e))t.push({path:o,message:"must be an object"});else{for(const n of["key","action"])n in e||t.push({path:`${o}.${n}`,message:"is required"});"key"in e&&"string"!=typeof e.key&&t.push({path:`${o}.key`,message:"must be a string"}),"action"in e&&"string"!=typeof e.action&&t.push({path:`${o}.action`,message:"must be a string"}),"args"in e&&("object"!=typeof e.args||null===e.args||Array.isArray(e.args))&&t.push({path:`${o}.args`,message:"must be an object"}),"modes"in e&&(Array.isArray(e.modes)?e.modes.forEach((e,n)=>{"string"!=typeof e&&t.push({path:`${o}.modes[${n}]`,message:"must be a string"})}):t.push({path:`${o}.modes`,message:"must be an array"})),"priority"in e&&(Number.isInteger(e.priority)?e.priority<0&&t.push({path:`${o}.priority`,message:"must be ≥ 0"}):t.push({path:`${o}.priority`,message:"must be an integer"}))}}):t.push({path:"commands",message:"must be an array"})),"ui"in e)if("object"!=typeof e.ui||null===e.ui||Array.isArray(e.ui))t.push({path:"ui",message:"must be an object"});else{if("slot"in e.ui){const n=e.ui.slot;["overlay","sidebar","toolbar","statusbar"].includes(n)||t.push({path:"ui.slot",message:"must be one of overlay, sidebar, toolbar, statusbar"})}"trigger"in e.ui&&"string"!=typeof e.ui.trigger&&t.push({path:"ui.trigger",message:"must be a string"})}return{valid:0===t.length,errors:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.validatePlugin=n,t.validatePlugins=function(e){const t=[],o=[];for(const r of e){const{valid:e,errors:s}=n(r);e?t.push(r):o.push({manifest:r,errors:s})}return{validPlugins:t,invalid:o}}},270:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return Object.assign({},o.scrollActions)};const o=n(184)},275:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalKeys=void 0,t.LocalKeys={scrollAmount:"scrollAmount"}},296:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.appDom=t.AppDom=void 0;class n{setDom(e){this.dom=e}getDom(){return this.dom}query(e){return this.dom?this.dom.querySelector(e):null}appendChild(e){this.dom instanceof HTMLElement?this.dom.appendChild(e):console.warn("AppDom: cannot appendChild—root is not an HTMLElement")}}t.AppDom=n,t.appDom=new n},363:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(748));n(296).appDom.setDom(document),(0,r.default)()},411:(e,t,n)=>{var o;!function(r,s){if(r){for(var i,a={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},c={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},l={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},u={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},d=1;d<20;++d)a[111+d]="f"+d;for(d=0;d<=9;++d)a[d+96]=d.toString();b.prototype.bind=function(e,t,n){var o=this;return e=e instanceof Array?e:[e],o._bindMultiple.call(o,e,t,n),o},b.prototype.unbind=function(e,t){return this.bind.call(this,e,function(){},t)},b.prototype.trigger=function(e,t){var n=this;return n._directMap[e+":"+t]&&n._directMap[e+":"+t]({},e),n},b.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},b.prototype.stopCallback=function(e,t){if((" "+t.className+" ").indexOf(" mousetrap ")>-1)return!1;if(v(t,this.target))return!1;if("composedPath"in e&&"function"==typeof e.composedPath){var n=e.composedPath()[0];n!==e.target&&(t=n)}return"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},b.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},b.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(a[t]=e[t]);i=null},b.init=function(){var e=b(s);for(var t in e)"_"!==t.charAt(0)&&(b[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},b.init(),r.Mousetrap=b,e.exports&&(e.exports=b),void 0===(o=function(){return b}.call(t,n,t,e))||(e.exports=o)}function p(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function f(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return a[e.which]?a[e.which]:c[e.which]?c[e.which]:String.fromCharCode(e.which).toLowerCase()}function h(e,t){return e.sort().join(",")===t.sort().join(",")}function m(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function g(e,t,n){return n||(n=function(){if(!i)for(var e in i={},a)e>95&&e<112||a.hasOwnProperty(e)&&(i[a[e]]=e);return i}()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function y(e,t){var n,o,r,s=[];for(n=function(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}(e),r=0;r<n.length;++r)o=n[r],u[o]&&(o=u[o]),t&&"keypress"!=t&&l[o]&&(o=l[o],s.push("shift")),m(o)&&s.push(o);return{key:o,modifiers:s,action:t=g(o,s,t)}}function v(e,t){return null!==e&&e!==s&&(e===t||v(e.parentNode,t))}function b(e){var t=this;if(e=e||s,!(t instanceof b))return new b(e);t.target=e,t._callbacks={},t._directMap={};var n,o={},r=!1,i=!1,a=!1;function c(e){e=e||{};var t,n=!1;for(t in o)e[t]?n=!0:o[t]=0;n||(a=!1)}function l(e,n,r,s,i,a){var c,l,u=[],d=r.type;if(!t._callbacks[e])return[];for("keyup"==d&&m(e)&&(n=[e]),c=0;c<t._callbacks[e].length;++c)if(l=t._callbacks[e][c],(s||!l.seq||o[l.seq]==l.level)&&d==l.action&&("keypress"==d&&!r.metaKey&&!r.ctrlKey||h(n,l.modifiers))){var p=!s&&l.combo==i,f=s&&l.seq==s&&l.level==a;(p||f)&&t._callbacks[e].splice(c,1),u.push(l)}return u}function u(e,n,o,r){t.stopCallback(n,n.target||n.srcElement,o,r)||!1===e(n,o)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(n),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(n))}function d(e){"number"!=typeof e.which&&(e.which=e.keyCode);var n=f(e);n&&("keyup"!=e.type||r!==n?t.handleKey(n,function(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}(e),e):r=!1)}function g(e,s,i,d,p){t._directMap[e+":"+i]=s;var h,m=(e=e.replace(/\s+/g," ")).split(" ");m.length>1?function(e,t,s,i){function l(t){return function(){a=t,++o[e],clearTimeout(n),n=setTimeout(c,1e3)}}function d(t){u(s,t,e),"keyup"!==i&&(r=f(t)),setTimeout(c,10)}o[e]=0;for(var p=0;p<t.length;++p){var h=p+1===t.length?d:l(i||y(t[p+1]).action);g(t[p],h,i,e,p)}}(e,m,s,i):(h=y(e,i),t._callbacks[h.key]=t._callbacks[h.key]||[],l(h.key,h.modifiers,{type:h.action},d,e,p),t._callbacks[h.key][d?"unshift":"push"]({callback:s,modifiers:h.modifiers,action:h.action,seq:d,level:p,combo:e}))}t._handleKey=function(e,t,n){var o,r=l(e,t,n),s={},d=0,p=!1;for(o=0;o<r.length;++o)r[o].seq&&(d=Math.max(d,r[o].level));for(o=0;o<r.length;++o)if(r[o].seq){if(r[o].level!=d)continue;p=!0,s[r[o].seq]=1,u(r[o].callback,n,r[o].combo,r[o].seq)}else p||u(r[o].callback,n,r[o].combo);var f="keypress"==n.type&&i;n.type!=a||m(e)||f||c(s),i=p&&"keydown"==n.type},t._bindMultiple=function(e,t,n){for(var o=0;o<e.length;++o)g(e[o],t,n)},p(e,"keypress",d),p(e,"keydown",d),p(e,"keyup",d)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},550:e=>{"use strict";e.exports=JSON.parse('{"name":"primeGenScroll","version":"0.2.0","priority":1,"commands":[{"key":"j","action":"core.scrollLine","args":{"amount":20}},{"key":"k","action":"core.scrollLine","args":{"amount":-20}},{"key":"Ctrl-d","action":"core.scrollHalfPage","args":{"direction":1}},{"key":"Ctrl-u","action":"core.scrollHalfPage","args":{"direction":-1}},{"key":"Ctrl-f","action":"core.scrollFullPage","args":{"direction":1}},{"key":"Ctrl-b","action":"core.scrollFullPage","args":{"direction":-1}},{"key":"gg","action":"core.jumpTop"},{"key":"G","action":"core.jumpBottom"},{"key":"<leader>ws","action":"core.focusNextPane"},{"key":"<leader>wS","action":"core.focusPrevPane"},{"key":"<leader>wp","action":"core.focusPaneByNumber","args":{"index":0}},{"key":"w","action":"core.moveChild"},{"key":"W","action":"core.moveParent"}]}')},564:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,s){function i(e){try{c(o.next(e))}catch(e){s(e)}}function a(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,a)}c((o=o.apply(e,t||[])).next())})},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PluginManager=void 0;const s=r(n(411)),i=n(986),a=n(675),c=n(640),l=n(745),u=n(199);t.PluginManager=class{constructor(e){this.namedMaps=e,this.manifests=[],this.actionMap=(0,l.flattenActionMaps)(e)}init(){return o(this,void 0,void 0,function*(){yield this.loadAndValidate(),this.resolveConflicts(),this.bindAll(),console.log(`[PluginManager] Loaded plugins: ${this.manifests.map(e=>e.name).join(", ")}`)})}loadAndValidate(){return o(this,void 0,void 0,function*(){const e=[...yield this.loadBuiltIn(),...yield this.loadUser()],{validPlugins:t,invalid:n}=(0,u.validatePlugins)(e);n.forEach(({manifest:e,errors:t})=>console.error("[PluginManager] Invalid plugin",e,t)),this.manifests=t})}resolveConflicts(){(0,c.findConflicts)(this.manifests).forEach(({mode:e,key:t,plugins:n},o)=>{console.warn(`[PluginManager] Conflict #${o+1} on key="${t}" in mode="${e}" among:`,n),n.slice(1).forEach(()=>{s.default.unbind(t)})})}bindAll(){s.default.reset(),this.manifests.forEach(e=>{e.commands.forEach(e=>{const t=e.key;s.default.bind(t,t=>{t.preventDefault();const n=(0,a.getCurrentMode)();if(e.modes&&!e.modes.includes(n))return;const o=this.actionMap[e.action];o?o(e.args):console.warn(`[PluginManager] No handler for action "${e.action}"`)})})})}loadBuiltIn(){return o(this,void 0,void 0,function*(){try{const e=n(657),t=e.keys();return console.debug("[PluginManager] Discovered plugin files:",t),t.map(t=>{const n=e(t);return console.debug(`[PluginManager] Loaded plugin module for ${t}:`,n),n})}catch(e){return console.warn("[PluginManager] Failed to load built-in plugins via context",e),[]}})}loadUser(){return new Promise(e=>{chrome.storage.sync.get(i.AppConstants.userPluginsKey,t=>{const n=[];(t[i.AppConstants.userPluginsKey]||[]).forEach(e=>{try{n.push(JSON.parse(atob(e)))}catch(e){}}),e(n)})})}}},640:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findConflicts=function(e){var t;const n=new Map;for(const o of e)for(const e of o.commands){const r=null!==(t=e.modes)&&void 0!==t?t:["normal"];for(const t of r){const r=`${t}:${e.key}`;n.has(r)||n.set(r,new Set),n.get(r).add(o.name)}}const o=[];for(const[e,t]of n)if(t.size>1){const[n,r]=e.split(":");o.push({mode:n,key:r,plugins:Array.from(t)})}return o}},657:(e,t,n)=>{var o={"./scroller.json":550};function r(e){var t=s(e);return n(t)}function s(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=s,e.exports=r,r.id=657},675:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initModeService=function(){document.addEventListener("focusin",e=>{const t=e.target;r=t.matches("input, textarea, [contenteditable]")?o.Modes.Insert:o.Modes.Normal})},t.getCurrentMode=function(){return r},t.setCurrentMode=function(e){r!==e&&(r=e,document.dispatchEvent(new CustomEvent("vimsurf:modeChanged",{detail:{mode:e}})))};const o=n(936);let r=o.Modes.Normal},745:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flattenActionMaps=function(e){return Object.entries(e).reduce((e,[t,n])=>{for(const[o,r]of Object.entries(n))e[`${t}.${o}`]=r;return e},{})}},748:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){(0,i.initModeService)(),(0,a.initScrollService)();const e=(0,r.default)();new s.PluginManager(e).init().then(()=>console.log("Vimsurf fully initialized!")).catch(e=>console.error("Failed to initialize plugins:",e))};const r=o(n(130)),s=n(564),i=n(675),a=n(866)},852:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppUnits=void 0,t.AppUnits={scrollAmount:40}},866:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initScrollService=function(){chrome.storage.sync.get(r.LocalKeys.scrollAmount,e=>{"number"==typeof e.scrollAmount&&i(e.scrollAmount)&&(s=e.scrollAmount)})},t.getScrollAmount=function(){return s},t.validateScrollAmount=i;const o=n(852),r=n(275);let s=o.AppUnits.scrollAmount;function i(e){return-9999<e&&e<9999}},936:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Modes=void 0,t.Modes={Normal:"normal",Insert:"insert",Visual:"visual"}},986:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppConstants=void 0,t.AppConstants={buildInPlugins:["default.json"],userPluginsKey:"userPlugins"}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,n),s.exports}n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n(363)})();